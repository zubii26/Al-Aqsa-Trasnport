// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Booking {
  id         String   @id @default(cuid())
  name       String
  email      String
  phone      String
  pickup     String
  dropoff    String
  date       String
  time       String
  vehicle    String
  passengers Int
  status     String   @default("pending")
  createdAt  DateTime @default(now())
  userId     String?  @db.Uuid
  price      String?
}

model Vehicle {
  id          String   @id @default(cuid())
  name        String
  image       String
  passengers  Int
  luggage     Int
  features    String[]
  price       String // Base price or daily rate
  hourlyRate  String? // Hourly rate for rentals
  category    String   @default("Standard") // Standard, Premium, VIP
  isActive    Boolean  @default(true)
  routePrices RoutePrice[]
}

model Settings {
  id        String   @id @default(cuid())
  key       String   @unique // e.g., "contact_phone", "social_facebook"
  value     String
  type      String   @default("text") // text, boolean, json
  updatedAt DateTime @updatedAt
}

model Route {
  id          String       @id @default(cuid())
  origin      String
  destination String
  distance    String?
  duration    String?
  category    String       @default("Intercity") // Airport, Intercity, Ziarat
  isActive    Boolean      @default(true)
  prices      RoutePrice[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model RoutePrice {
  id        String   @id @default(cuid())
  routeId   String
  vehicleId String
  price     Float
  route     Route    @relation(fields: [routeId], references: [id], onDelete: Cascade)
  vehicle   Vehicle  @relation(fields: [vehicleId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([routeId, vehicleId])
}

model AuditLog {
  id        String   @id @default(cuid())
  action    String   // CREATE, UPDATE, DELETE
  entity    String   // Vehicle, Route, Settings
  entityId  String?
  details   String?
  user      String   // Admin username or ID
  timestamp DateTime @default(now())
}

model Review {
  id             String   @id @default(cuid())
  author         String
  rating         Int
  comment        String?
  date           DateTime
  source         String   @default("google") // 'google', 'manual'
  isVisible      Boolean  @default(true)
  status         String   @default("approved") // pending, approved, rejected
  reply          String?
  avatar         String?
  googleReviewId String?  @unique
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model BlogPost {
  id        String   @id // Slug
  title     String
  excerpt   String
  content   String   @db.Text
  category  String
  date      DateTime @default(now())
  readTime  String
  image     String
  alt       String
  author    String
  tags      String[]
  isPublished Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model User {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  password  String   // Hashed
  role      String   @default("MANAGER") // 'ADMIN', 'MANAGER'
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
